/* ==========================================================================
   CUSTOM CSS BY ME
   ========================================================================== */

/*
   Visibility
   ========================================================================== */

.zoom{
  /* default button */
  
  &:hover {
    transform: scale(1.25);
  }
}

.container {
  position: relative;
  width: 100%;
  max-width: 400px;
}

/* overlay effect (full height and width) - lays on top of the container */
.overlay {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  height: 100%;
  width: 100%;
  opacity: 0;
  transition: .3s ease;
  background-color: $dark-gray;
}

/* When you mouse over the container, fade in the overlay */
.container:hover .overlay {
  opacity: 0.25;
}

/* ==========================================================================
   Talks page (data-driven, compact, no thumbnails)
   Safe: only targets new talks-specific classes used on /talks/
   ========================================================================== */

.talks-list{
  display:flex;
  flex-direction:column;
  gap:.8rem;
  margin-top:1rem;
}

.talk-card{
  padding:.8rem .95rem;
  border:1px solid rgba(0,0,0,.12);
  border-radius:14px;
  background: rgba(255,255,255,.95);
  box-shadow: 0 8px 20px rgba(0,0,0,.05);
}

/* Header: title + actions, stays aligned even when title is long */
.talk-card__header{
  display:grid;
  grid-template-columns: 1fr auto;
  gap:.5rem .9rem;
  align-items:start;
}

.talk-card__title{
  margin:0;
  font-size:1.06rem;
  line-height:1.2;
  overflow-wrap:anywhere;
  word-break:normal;
  min-width:0;
}

.talk-card__actions{
  display:flex;
  gap:.4rem;
  flex-wrap:wrap;
  justify-content:flex-end;
  align-items:flex-start;
}

/* Keep buttons compact without affecting global .btn styles */
.talk-card__actions .btn{
  white-space:nowrap;
  font-size:.82rem;
  padding:.35rem .55rem;
}

/* 1) Make meta lines handle taller items cleanly (helps when details opens) */
.talk-card__meta-line{
  align-items:flex-start;
}

/* 2) CRITICAL: allow the details expander to shrink instead of forcing overflow */
.talk-chip-pair > .talk-more{
  flex: 0 1 auto;      /* was 0 0 auto */
  min-width: 0;        /* allows shrinking in flex */
  max-width: 100%;
}

.talk-chip-pair > .talk-chip--topic{
  flex: 1 1 auto;
  min-width:0;
}

.talk-chip-pair > .talk-more{
  flex: 0 0 auto;
  align-self:flex-start; /* keep the +N pill pinned to the top */
}

/* Label used for Topics/Tools/Audience rows */
.talk-card__meta-label{
  font-size:.70rem;
  text-transform:uppercase;
  letter-spacing:.04em;
  opacity:.7;
  margin-right:.35rem;
}

/* "+N more" expander (details) */
.talk-more{
  display:inline-block;
  margin:0;
  padding:0;
}

/* Summary styling */
.talk-more > summary{
  list-style:none;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  margin:0;
  outline:none;
  user-select:none;
  box-sizing:border-box;
  vertical-align:top;
  font-weight:400;
  white-space:nowrap;
  -webkit-tap-highlight-color: transparent;
}

.talk-more > summary::-webkit-details-marker{
  display:none;
}

/* Firefox marker removal */
.talk-more > summary::marker{
  content:"";
}

/* No ring on mouse-click focus */
.talk-more > summary:focus{
  box-shadow:none;
}

/* Ring only for keyboard focus */
.talk-more > summary:focus-visible{
  box-shadow: inset 0 0 0 2px rgba(0,0,0,.12);
}

/* Fixed-width caret that rotates */
.talk-more > summary::after{
  content:"▸";
  display:inline-block;
  width:1ch;
  margin-left:.25rem;
  opacity:.7;
  transform: rotate(0deg);
  transform-origin: 50% 50%;
  transition: transform .12s ease;
}

.talk-more[open] > summary::after{
  transform: rotate(90deg);
}

/* 3) Ensure expanded chips wrap within the available width */
.talk-more__content{
  width: 100%;
  max-width: 100%;
}

/* Make chips single-line to avoid height jumps */
.talk-chip--topic,
.talk-chip--tool,
.talk-chip--audience{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width:100%;
  min-width:0;
}

/* Collapsible description */
.talk-desc{
  margin:.6rem 0 0 0;
}

.talk-desc__summary{
  cursor:pointer;
  font-size:.70rem;
  text-transform:uppercase;
  letter-spacing:.04em;
  opacity:.7;
  font-weight:600;
  list-style:none;

  display:inline-flex;
  align-items:center;
  gap:.35rem;
}

.talk-desc__summary::-webkit-details-marker{
  display:none;
}

/* Firefox marker removal */
.talk-desc__summary::marker{
  content:"";
}

/* caret affordance for Description */
.talk-desc__summary::before{
  content:"▸";
  opacity:.8;
}

.talk-desc[open] > .talk-desc__summary::before{
  content:"▾";
}

/* Optional: hover affordance */
.talk-desc__summary:hover{
  text-decoration: underline;
}

.talk-desc__body{
  margin-top:.45rem;
  font-size:.88rem;
  line-height:1.32;
}

.talk-desc__body p{
  margin:.35rem 0;
}

/* Optional: clarify open state */
.talk-more[open] > summary{
  opacity: 1;
}
.talk-desc[open] > .talk-desc__summary{
  opacity: 1;
}

/* "Chips" for event/date/location */
.talk-chip{
  display:inline-flex;
  align-items:center;
  padding:.15rem .45rem;
  border-radius:999px;
  border:1px solid rgba(0,0,0,.12);
  background: rgba(0,0,0,.02);
  font-size:.84rem;
  line-height:1.15;
  max-width:100%;
  overflow-wrap:anywhere;
  word-break:normal;
}

.talk-chip--event{
  font-weight:600;
}

/* Subtle differentiation for chip types */
.talk-chip--more{
  opacity:.8;
  cursor:pointer;
}

.talk-chip--tool{ }
.talk-chip--audience{ }

/* Description: compact but readable (legacy; safe to keep even if unused now) */
.talk-card__desc{
  margin:.5rem 0 0 0;
  font-size:.88rem;
  line-height:1.32;
}

.talk-card__desc-label{
  display:inline-block;
  font-size:.70rem;
  text-transform:uppercase;
  letter-spacing:.04em;
  opacity:.7;
  margin-right:.35rem;
}

.talk-card__desc-text{
  overflow-wrap:anywhere;
  word-break:normal;
}

/* Mobile: stack actions under title */
@media (max-width: 900px){
  .talk-card__header{
    grid-template-columns: 1fr;
  }
  .talk-card__actions{
    justify-content:flex-start;
  }
}

/* ==========================================================================
   CV page (auto-latest PDF)
   Safe: only targets .cv-iframe used on /cv/
   ========================================================================== */

/* Hide iframe on small screens (matches prior behavior) */
@media (max-width: 768px) {
  .cv-iframe { display: none; }
}

/* Show full-width iframe on larger screens */
@media (min-width: 769px) {
  .cv-iframe { width: 100%; display: block; }
}

/* ==========================================================================
   Research page: phylo-methods poster iframe
   Safe: only targets .phylo-methods-iframe on that page
   ========================================================================== */

@media (max-width: 768px) {
  .phylo-methods-iframe { display: none; }
}

@media (min-width: 769px) {
  .phylo-methods-iframe { width: 100%; display: block; }
}

/* ==========================================================================
   Publications page
   Scoped to .pubs-page to avoid affecting other archive pages
   ========================================================================== */

.pubs-page {
  /* === Anchor offset for sticky header === */
  .pub-year {
    scroll-margin-top: 96px;
  }

  .pub-year:target::before {
    content: "";
    display: block;
    height: 96px;
    margin-top: -96px;
  }

  /* Jump nav + year headings */
  .pubs-jump { margin: .5rem 0 1rem 0; font-size: .95em; }
  .pubs-jump a { text-decoration: none; margin-right: .6em; }

  /* Year headings */
  .pub-year {
    margin: 1.1rem 0 .55rem 0;
    border-bottom: 1px solid #ddd;
    padding-bottom: .25rem;
    font-weight: 600;
  }

  /* List spacing */
  .pub-list { list-style: none; margin: 0 0 1rem 0; padding: 0; }
  .pub-list > li { margin: 0 0 .6rem 0; }

  /* Publication item formatting (scoped so it won't affect other pages) */
  .archive__item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: .9rem;
    font-size: 16px;
  }

  .archive__item-details { flex-grow: 1; width: 80%; }

  .archive__item-title {
    margin-bottom: .12rem;
    line-height: 1.25;
    font-weight: 600;
    font-size: 20px;
  }
  .archive__item-title a { text-decoration: none; }
  .archive__item-title a:hover { text-decoration: underline; }

  .archive__item-details p {
    margin: .15rem 0 .25rem 0;
    font-size: .95em;
    color: #555;
    line-height: 1.45;
  }

  /* Icons */
  .archive__item-details a .fa,
  .archive__item-details a .fas,
  .archive__item-details a .fab {
    opacity: .8;
    transform: translateY(0);
    transition: opacity .12s ease, transform .12s ease;
  }
  .archive__item-details a:hover .fa,
  .archive__item-details a:hover .fas,
  .archive__item-details a:hover .fab {
    opacity: 1;
    transform: translateY(-1px);
  }

  .read-more-link {
    font-size: 15px;
    font-weight: normal;
    color: #2a79ab;
    text-decoration: underline;
  }

  .read-more-link:hover {
    color: #1d5578;
  }

  /* Altmetric column */
  .archive__item-altmetric {
    width: 15%;
    min-width: 140px;
    padding-left: 1rem;
    margin-right: 2rem;
  }

  @media (max-width: 860px) {
    .archive__item { flex-direction: column; align-items: flex-start; }
    .archive__item-altmetric { width: 100%; padding-left: 0; margin: .35rem 0 0 0; }
  }

  /* Cover image row */
  .pub-covers {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    max-width: 70%;
    margin: 0 auto 2rem auto;
    justify-items: center;
  }

  .pub-covers a {
    display: flex;
    justify-content: center;
  }

  .pub-covers img {
    max-height: 250px;
    width: auto;
    max-width: 100%;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    transition: box-shadow 0.3s ease;
  }

  .pub-covers img:hover {
    box-shadow: 0 12px 24px rgba(0,0,0,0.3);
  }

  @media (max-width: 720px) {
    .pub-covers {
      grid-template-columns: 1fr;
      max-width: 90%;
    }
  }
}

/* ==========================================================================
   Masthead tweaks (moved out of _includes/masthead.html)
   ========================================================================== */

.masthead__menu-item--lg img {
  max-height: 25px;
}

.masthead__menu-item a {
  font-size: 20px;
}

/* ==========================================================================
   Research page: phylo-history embeds
   Safe: only targets .phylo-history-iframe and .phylo-history-embed
   ========================================================================== */

/* Hide embeds on small screens (matches prior behavior on that page) */
@media (max-width: 768px) {
  .phylo-history-iframe { display: none; }
  .phylo-history-embed { display: none; }
}

/* Show embeds on larger screens */
@media (min-width: 769px) {
  .phylo-history-iframe { width: 100%; display: block; }
  .phylo-history-embed { width: 100%; display: block; }
}

/* ==========================================================================
   News page (/news/)
   Scoped to .news-page so it won't affect other archive pages
   ========================================================================== */

.news-page {
  font-size: 0.9em;
  line-height: 1.35;
  color: #333;

  /* Offset anchor targets so they don't hide under the sticky header */
  .news-year-title { scroll-margin-top: 96px; }
  .news-year-title:target::before {
    content: "";
    display: block;
    height: 96px;
    margin-top: -96px;
  }

  /* Jump links */
  .news-jump {
    margin: .45rem 0 1rem 0;
    font-size: .82em;
    text-transform: lowercase;
    letter-spacing: .01em;
    color: #555;
  }
  .news-jump__link {
    text-decoration: none;
    margin-right: .42em;
  }
  .news-jump__link:hover {
    text-decoration: underline;
  }

  /* Year headings */
  .news-year-title {
    margin-top: 1.35rem;
    border-bottom: 1px solid #ddd;
    padding-bottom: 0.35rem;
    margin-bottom: 0.55rem;
    line-height: 1.2;
  }

  /* News list styling */
  .news-year {
    list-style: none;
    margin: 0 0 .95rem 0;
    padding: 0;
  }

  .news-item {
    display: grid;
    grid-template-columns: 6.75rem minmax(0, 1fr);
    gap: .16rem .92rem;
    align-items: baseline;
    margin: 0 0 .34rem 0;
    line-height: 1.35;
  }

  .news-date {
    display: block;
    color: #555;
    font-size: .85em;
    text-align: left;
    white-space: nowrap;
  }

  .news-link {
    text-decoration: none;
    min-width: 0;
    overflow-wrap: anywhere;
  }
  .news-link:hover {
    text-decoration: underline;
  }

  /* Back to top */
  .news-backtotop {
    margin-top: .95rem;
    font-size: .9em;
  }
  .news-backtotop__link {
    text-decoration: none;
  }
  .news-backtotop__link:hover {
    text-decoration: underline;
  }

  @media (max-width: 900px) {
    .news-item {
      grid-template-columns: 6.15rem minmax(0, 1fr);
      gap: .14rem .8rem;
    }
  }

  @media (max-width: 720px) {
    .news-year {
      margin-bottom: 1rem;
    }
    .news-item {
      grid-template-columns: 1fr;
      gap: .08rem 0;
      margin-bottom: .45rem;
    }
    .news-date {
      font-weight: 600;
      white-space: normal;
    }
  }
}

/* ==========================================================================
   Background page (/background/)
   Scoped to .bg-page so it won't affect other pages
   ========================================================================== */

.bg-page{
  font-size: 0.9em;
  line-height: 1.35;
  color: #333;
}

/* Small section label (matches about/news vibe) */
.bg-kicker{
  margin: 0 0 .35rem 0;
  font-size: .72rem;
  text-transform: uppercase;
  letter-spacing: .06em;
  opacity: .65;
  font-weight: 600;
}

/* Current “card” */
.bg-current{
  display: grid;
  grid-template-columns: 1fr 240px;
  gap: 1rem 1.5rem;
  align-items: start;

  padding: .9rem 1rem;
  border: 1px solid rgba(0,0,0,.12);
  border-radius: 14px;
  background: rgba(255,255,255,.95);
  box-shadow: 0 8px 20px rgba(0,0,0,.05);
}

.bg-current__logo a{ display: block; }
.bg-current__logo img{
  width: 100%;
  height: auto;
  display: block;
  pointer-events: none;
}

.bg-divider{
  border: none;
  border-top: 1px solid #ddd;
  margin: 1.1rem 0;
}

/* Timeline */
.bg-timeline{
  list-style: none;
  margin: 0;
  padding: 0;

  display: flex;
  flex-direction: column;
  gap: .85rem;
}

.bg-item{
  display: grid;
  grid-template-columns: 6.5rem 1fr;
  gap: .2rem 1rem;
  align-items: start;
}

.bg-when{
  font-size: .85em;
  color: #555;
  white-space: nowrap;
}

.bg-what{ min-width: 0; }
.bg-what p{ margin: .15rem 0; }

/* Affiliations grid */
.bg-affiliations{
  list-style: none;
  margin: 0;
  padding: 0;

  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: .35rem 1.3rem;
}

.bg-affiliations li{ margin: 0; }
.bg-affiliations a{ text-decoration: none; }
.bg-affiliations a:hover{ text-decoration: underline; }

/* Responsive */
@media (max-width: 900px){
  .bg-current{
    grid-template-columns: 1fr;
  }
  .bg-current__logo{
    max-width: 320px;
  }
}

@media (max-width: 600px){
  .bg-item{
    grid-template-columns: 1fr;
  }
  .bg-when{
    font-weight: 600;
  }
}
